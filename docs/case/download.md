# 下载文件

## 基本方案

- 使用`window.open()`
  :::warning
  优点: 使用简单
  缺点:
  - 浏览器会闪烁一下，体验不好
  - 对于浏览器支持的文件(例如: `.html`, `.pdf`),会在页签中打开，不会下载
    多文件下载:
  - 使用 `window.open([url], [window name])` [window name]需要不同的命名
  - 浏览器会多次闪烁
  - 浏览器会切换到左边的页签
    :::

```js
window.open("./download.md", "download");
```

- 利用`window.location.href`
  :::warning
  优点: 使用简单  
  缺点:
  - 浏览器会有加载的动作
  - 对于浏览器支持的文件(例如: `.html`, `.pdf`),会在页签中打开，不会下载
  - 多个文件同时下载时，前面的请求会被`cancelled`,只有最后一条数据，才会正确的下载
    :::

```js
window.location.href = "./download.md";
```

- 使用`<a></a>`标签
  :::warning
  优点:
  - 浏览器直接下载，没有其他多余的动作，体验感很好
  - `<a href=[链接] downlod=[文件名.拓展名]>`,浏览器支持的文件(例如: `.html`, `.pdf`),也支持下载
  - 支持 blob 文件
    缺点:
  - 一般需要动态创建`<a></a>`标签，同时需要调用`.click()`事件，然后调用`.remove()`事件手动清除
  - download 属性，生效需要同源或者`blob:`、`data:`协议。现实中，文件一般在 cdn 或者文件系统中，很难同源，这是就需要使用`blob:`协议
  - `blob:`协议，请求过程中，不会出现进度条，下载会在网络进程中，前端无法感知
  - 多文件同时下载，download 属性生效时，download 属性需要赋不同的值，才可以正常下载，否则，前面的请求会全部`cancelled`,只有最后一个才能正常的请求完成
  - 多文件同时下载，download 属性不生效时，如果不是`blob:`协议，则同时下载多个文件时，前面的请求全部`cancelled`,只有最后一个才能正常的请求完成；如果是`blob:`协议，可以正常的多次请求
  - :::
  ```js
  // 动态创建<a>标签，使用blob:协议下载
  ```
- 使用`<iframe />`
  :::warning
  优点:
  - 只需要 src 属性上赋值，多文件就可以同时下载
    缺点:
  - 需要动态创建`<iframe />`标签
  - 浏览器支持的文件(例如: `.html`, `.pdf`)不会进行下载
  - 非同源下载链接，`onload`事件，不会触发，就无法及时的清除`<iframe />`标签
    :::
